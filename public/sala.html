<!DOCTYPE html><html lang="pt-BR">
<head>
ยย<meta charset="UTF-8" />
ยย<meta name="viewport" content="width=device-width, initial-scale=1.0" />
ยย<title>Sala Global</title>
ยย<style>
ยยยยbody {
ยยยยยยbackground-color: #1e1e1e;
ยยยยยยcolor: white;
ยยยยยยfont-family: Arial, sans-serif;
ยยยยยยdisplay: flex;
ยยยยยยflex-direction: column;
ยยยยยยheight: 100vh;
ยยยยยยmargin: 0;
ยยยย}
ยยยยheader {
ยยยยยยbackground-color: #2a2a2a;
ยยยยยยpadding: 1rem;
ยยยยยยdisplay: flex;
ยยยยยยjustify-content: space-between;
ยยยยยยalign-items: center;
ยยยย}
ยยยย#usuarios {
ยยยยยยbackground-color: #2a2a2a;
ยยยยยยpadding: 1rem;
ยยยยยยposition: absolute;
ยยยยยยtop: 0;
ยยยยยยright: 0;
ยยยยยยwidth: 250px;
ยยยยยยheight: 100%;
ยยยยยยoverflow-y: auto;
ยยยยยยdisplay: none;
ยยยย}
ยยยย#chat {
ยยยยยยflex: 1;
ยยยยยยpadding: 1rem;
ยยยยยยoverflow-y: auto;
ยยยยยยbackground-color: #1e1e1e;
ยยยย}
ยยยยform {
ยยยยยยdisplay: flex;
ยยยยยยgap: 0.5rem;
ยยยยยยpadding: 1rem;
ยยยยยยbackground-color: #2a2a2a;
ยยยยยยalign-items: center;
ยยยย}
ยยยยinput[type="text"] {
ยยยยยยflex: 1;
ยยยยยยpadding: 0.5rem;
ยยยยยยborder: none;
ยยยยยยborder-radius: 4px;
ยยยยยยfont-size: 1rem;
ยยยย}
ยยยยbutton, label[for="imagemInput"] {
ยยยยยยbackground-color: #4caf50;
ยยยยยยborder: none;
ยยยยยยpadding: 0.5rem;
ยยยยยยborder-radius: 4px;
ยยยยยยcursor: pointer;
ยยยยยยcolor: white;
ยยยยยยfont-size: 1rem;
ยยยย}
ยยยยbutton:hover, label[for="imagemInput"]:hover {
ยยยยยยbackground-color: #45a049;
ยยยย}
ยยยย#imagemInput {
ยยยยยยdisplay: none;
ยยยย}
ยยยย.usuario-item {
ยยยยยยcursor: pointer;
ยยยยยยcolor: #4fc3f7;
ยยยยยยtext-decoration: underline;
ยยยยยยmargin-bottom: 0.5rem;
ยยยยยยdisplay: block;
ยยยย}
ยย</style>
</head>
<body>
ยย<header>
ยยยย<h2>Sala Global</h2>
ยยยย<button id="toggleUsuarios">Usuรกrios</button>
ยย</header>
ยย<div id="usuarios">
ยยยย<button id="fecharUsuarios">Fechar</button>
ยยยย<h3>Usuรกrios Online</h3>
ยยยย<ul id="listaUsuarios"></ul>
ยย</div>
ยย<div id="chat"></div>
ยย<form id="form">
ยยยย<input type="text" id="mensagem" placeholder="Digite sua mensagem" autocomplete="off" />
ยยยย<label for="imagemInput" title="Enviar imagem">๐ผ๏ธ</label>
ยยยย<input type="file" id="imagemInput" accept="image/*">
ยยยย<button type="submit">Enviar</button>
ยย</form>ยย<script src="/socket.io/socket.io.js"></script> ยย<script> ยยยยconst socket = io(); ยยยยconst chat = document.getElementById('chat'); ยยยยconst form = document.getElementById('form'); ยยยยconst mensagemInput = document.getElementById('mensagem'); ยยยยconst imagemInput = document.getElementById('imagemInput'); ยยยยconst listaUsuarios = document.getElementById('listaUsuarios'); ยยยยconst toggleUsuarios = document.getElementById('toggleUsuarios'); ยยยยconst fecharUsuarios = document.getElementById('fecharUsuarios');

ยยยยconst urlParams = new URLSearchParams(window.location.search); ยยยยconst username = urlParams.get('username') || 'Anรดnimo';

ยยยยlet usuariosOnline = [];

ยยยยsocket.emit('usuario_entrando', username);

ยยยยtoggleUsuarios.onclick = () => { ยยยยยยdocument.getElementById('usuarios').style.display = 'block'; ยยยย}; ยยยยfecharUsuarios.onclick = () => { ยยยยยยdocument.getElementById('usuarios').style.display = 'none'; ยยยย};

ยยยยform.addEventListener('submit', e => { ยยยยยยe.preventDefault(); ยยยยยยconst texto = mensagemInput.value.trim(); ยยยยยยif (texto) { ยยยยยยยยsocket.emit('mensagem', { nome: username, texto }); ยยยยยยยยmensagemInput.value = ''; ยยยยยย} ยยยย});

ยยยยimagemInput.addEventListener('change', () => { ยยยยยยconst file = imagemInput.files[0]; ยยยยยยif (!file) return; ยยยยยยconst reader = new FileReader(); ยยยยยยreader.onload = () => { ยยยยยยยยsocket.emit('imagem', { nome: username, imagem: reader.result }); ยยยยยย}; ยยยยยยreader.readAsDataURL(file); ยยยย});

ยยยยsocket.on('usuarios_online', nomes => { ยยยยยยusuariosOnline = nomes; ยยยยยยlistaUsuarios.innerHTML = ''; ยยยยยยnomes.forEach(nome => { ยยยยยยยยconst li = document.createElement('li'); ยยยยยยยยli.textContent = nome; ยยยยยยยยli.classList.add('usuario-item'); ยยยยยยยยli.onclick = () => { ยยยยยยยยยยmensagemInput.value += @${nome} ; ยยยยยยยยยยmensagemInput.focus(); ยยยยยยยย}; ยยยยยยยยlistaUsuarios.appendChild(li); ยยยยยย}); ยยยย});

ยยยยsocket.on('mensagem', data => { ยยยยยยconst div = document.createElement('div'); ยยยยยยlet texto = data.texto; ยยยยยยusuariosOnline.forEach(nome => { ยยยยยยยยconst regex = new RegExp(@${nome}\\b, 'g'); ยยยยยยยยtexto = texto.replace(regex, <strong style="color:#ffd54f">@${nome}</strong>); ยยยยยย}); ยยยยยยdiv.innerHTML = <strong>${data.nome}:</strong> ${texto}; ยยยยยยchat.appendChild(div); ยยยยยยchat.scrollTop = chat.scrollHeight; ยยยย});

ยยยยsocket.on('imagem', data => { ยยยยยยconst div = document.createElement('div'); ยยยยยยdiv.innerHTML = <strong>${data.nome}:</strong> <br><img src="${data.imagem}" alt="imagem" style="max-width: 200px; display:block;" /><button onclick="this.previousElementSibling.style.display=this.previousElementSibling.style.display==='none'?'block':'none'">Ver/Ocultar</button>; ยยยยยยchat.appendChild(div); ยยยยยยchat.scrollTop = chat.scrollHeight; ยยยย}); ยย</script>

</body>
</html>
